---
title: "projectAnalysis_NAME"
subtitle: "BIO 201 Project Data Analysis"
author: "Your Name"
date: "November , 2025"
format: 
  html:
    code-overflow: wrap
    embed-resources: true
---

## Load necessary packages

Run the code below at the start of the session to make sure all the necessary packages are loaded. If you add any packages, put them in this same code chunk and put a comment next to it for what you used it for.

It is recommended that you put all your code to load packages in one R chunk at the start. Run the chunk below by clicking the little green arrow at the top right of the code chunk.

```{r}
#| label: setup
#| warning: false
#| message: false

suppressPackageStartupMessages(
  library(tidyverse)) ## for readr, dplyr, ggplot2
library(rstatix, warn.conflicts = FALSE) #pipe friendly framework for basic stats
library(ggpubr, warn.conflicts = FALSE) #publication ready plots & QQ plots
library(labelled) #for labeling variables better


```


Copy, paste, and tweak the necessary script templates into the code chunks below.


## Import Data


```{r}
#| label: import data



```

Make sure your data imported correctly by looking at it. 

Next we will relabel some of our variables so they can easily be used with the template code and avoid rewriting the column names a lot of times.

Replace **ONLY** the blanks in the code below as instructed

```{r}
#| label: define variables

#Define your variables and redefine your dataframe name here to avoid having to type them a lot

#define the continuous variable of choice 
cont.var <- "___" 

#define the categorical variable that is your within-subjects factor column name
#remove these two lines if you do not have a within-subjects factor
w.factor.var <- "___"
w.predictor <- "___"

#define the categorical variable that is your between-subjects factor column name
##remove these two lines if you do not have a between-subjects factor
b.factor.var <- "___"
b.predictor <- "___"

#define the name of the column that contains your subject identifiers
subject.ID <- "___"

#define the within subjects formula using variable names above
##remove these two lines if you do not have a within-subjects factor
    response <- cont.var
    formula_string.w <- paste0(response, " ~ ", w.predictor)
    formula_object.w <- as.formula(formula_string.w)
    
#define the between subjects formula using variable names above
##remove these two lines if you do not have a between-subjects factor
    response <- cont.var
    formula_string.b <- paste0(response, " ~ ", b.predictor)
    formula_object.b <- as.formula(formula_string.b)

```



## Data Exploration

### QQ Plots to Assess Normality

Check to see if the continuous dependent variable is normally distributed.

```{r}
#| label: Dependent variable QQ plots 



```


### Check for outliers

Let's look for outliers next.

```{r}
#| label: identify outliers 




```


The result above shows how many rows (if any) contain outliers. If it says 0 rows, that would indicate that there were no outliers. 

You may want to click on the little "Show in new window" icon at the top right of the results to see the whole table of results more easily. Either way, make sure you fully scroll to the right to see the last column in the results labeled "is.extreme". If there are any extreme outliers, you may want to filter those subjects out and rerun the descriptive statistics. 

If there are no extreme outliers, then delete the code chunk below. If there are outliers that you remove, you must note that you removed them and why in your results (you might want to look at the information about the subject to see if you can see why they were an outlier or make sure you wrote the values down correctly in the original spreadsheet). You may want to run the analysis with and without the outlier(s) so see how they impact the results.

```{r}
#| label: remove outliers

#if you want to remove an outlier
#fill in the blank with the number of the subject you want to remove
#you can remove more than one by adding subject != ___ more than once
#within the filter function separated by a comma
#dplyr::filter(subject != ___, subject != ___)


df <- df |> 
  dplyr::filter(subject != ___)


```


### Descriptive Statistics

I recommend starting with the script to give you all the descriptive statistics. Then you will have everything in your notes in case you need them later. 

```{r}
#| label: descriptive stats



```

Paste in the template code for rounding the SD below

```{r}
#| label: rounding the SD




```

Round the descriptive statistics to the same decimal place as the rounded SD values given above.

```{r}
#| label: rounded descriptive stats



```


If you decide you want a formatted table of a subset of the descriptive statistics, then load the `flextable` package in the setup code chunk at the start of this Quarto file and then add a code chunk to make the desired formatted table below.



### HRV Graph

Let's graph the HRV variable. 

```{r}
#| label: HRV graph




```

Make sure you have inlcuded proper axis titles that include units where needed. Make sure to also use the correct measure of central tendency (mean if data are normal, median if data are not normal). You can change the stat_summary code above from mean to median as needed.

## Save your graphs

Save your graph with the `ggsave()` function. You can find the "saving.graphs.R" template in the "script_templates" then "graphing" folder


```{r}
#| label: Save your graphs
#| eval: false

# save the graph! (.png or .jpg file types are recommended)
ggsave(filename = "results/HRVgraph.png",  
       plot = line.plot,   #put the object name of your plot here
       height = 5, width = 8, units = "in", 
       dpi = 300)

```


## Inferential Statistics

### Effect Size Calculations

To pick the right test, we need to determine if the distribution is normal and if the variance is equal.

-   **Normal Distribution, Equal Variance:** If the data is normal, and the two groups have similar dispersion (i.e. similar variance), then you should use "regular" **Cohen's d effect size (*d*)**

-   **Unequal Variance:** If the data has unequal dispersion (i.e. unequal variance), then you should use the **Cohen's d for Welch test effect size (*d*)**

-   **Non-normal Distribution, Equal Variance:** If the data is NOT normal but the two groups have similar dispersion (i.e. similar variance), then you should use the **Wilcoxon effect size (*r*)** (note that some statisticians recommend to use the Cohen's d for Welch test effect size if the variance is very different even if the distribution is not normal)

Select the correct effect size from the script templerates based on your data. Select the entire script (control-A or command-A), copy it (control-C or command-C), paste it in the code chunk below (control-V or command-V), and then run it.

```{r}
#| label: effect size





```

The effect size is the difference between typical values standardized by the amount of variation in the data (the exact equation depends on which effect size you use). The effect size here was calculated by taking 1000 bootstrapped random samples and the 95% confidence intervals were calculated with the adjusted bootstrap percentile (BCa) method.

The interpretation of the standardized effect size is included in the magnitude column - negligible, small, moderate, or large. This will help you determine if the difference between means or medians is meaningful or not. The 95% confidence intervals tells you how precisely the effect size was estimated. If the 95% confidence interval does not include zero, it suggests that the effect is statistically significant

::: {.callout-note appearance="minimal"}
## Optional Additional Resources on Effect Sizes

-   How to use the `rstatix` package to calculate effect sizes

    -   **Cohen’s d for Student t-test** on the [T-test Effect Size using Cohen's d Measure](https://www.datanovia.com/en/lessons/t-test-effect-size-using-cohens-d-measure/) webpage

    -   **Cohen’s d for Welch test** on the [T-test Effect Size using Cohen's d Measure](https://www.datanovia.com/en/lessons/t-test-effect-size-using-cohens-d-measure/) webpage

    -   **Effect size** under **Wilcoxon rank sum test** on the [Wilcoxon Test in R](https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/) webpage

-   To learn more about inferential tests to compare two groups

    -   compare means with normal distribution: [t-Test](https://datatab.net/tutorial/t-test)

    -   rank-sum test to compare two independent samples that are not normally distributed: [Mann-Whitney U-Test](https://datatab.net/tutorial/mann-whitney-u-test)

    -   signed-rank test to compare paired groups that are not normally distributed: [Wilcoxon signed-rank test](https://datatab.net/tutorial/wilcoxon-test)

-   [Alternatives to P value: confidence interval and effect size](https://pmc.ncbi.nlm.nih.gov/articles/PMC5133225/)
:::


### Effect Size Graph

Let's make a graph of the effect size results to make it more visual 


```{r}
#| label: effect size graph

effect.plot <- effectSize.results  |>    
  ggplot(aes(
    x=comparison, 
    y=effsize)) +
  
  geom_pointrange(aes(ymin = conf.low, ymax = conf.high),
                  size = 1, # Adjust point size
                  linewidth = 0.8, # Adjust line thickness
                  color = "steelblue") + # Set color
  geom_hline(yintercept = 0, linetype = "dashed", color = "grey50") + # Add a reference line at 0
  xlab("Comparison") +
  ylab("Standardized Effect Size") +
  #additional formatting
  theme_classic(base_size = 14)  +  #sets the font size
   theme(
    plot.title = element_text(size = 12),  # Set title size
    plot.subtitle = element_text(size = 12) # Set subtitle size to the same value
  ) +
  theme(legend.position = "none")   #controls legend/key

effect.plot

```

This shows the effect size results visually. In this case, the points represent the value of the effect size that you chose (Cohen's d, Cohen's d for Welch test, or the Wilcoxon paired signed-rank test) for three comparisons, and the vertical lines represent the 95% confidence interval calculated using the adjusted bootstrap percentile (BCa) method.

If the 95% CI includes zero (shown by crossing over the dotted line), then that effect size is not significantly different from zero (meaning there is no evidence of an effect). 

Let's use `ggsave()` again to save a copy of the effect size graph.

```{r}
#| label: Save your effect size graph 
#| eval: false  

# save the graph! (.png or .jpg file types are recommended)
ggsave(filename = "results/EffectSizeGraph.png",  
       plot = effect.plot,   #put the object name of your plot here
       height = 5, width = 8, units = "in", 
       dpi = 300)
```





## Finishing Up

Any graph files you save using the template code with the `ggsave()` function should appear in the results folder within the project folder.

If you are working on the Smith server, you will first need to export this file to your computer (it is simplest to do one graph at a time):

-   Check the box next to the graph file

-   Go to the "More" menu with the gear icon and click the drop down arrow

-   Select "Export" and then save the file to your computer

You can now insert this graph into your Group Folder and Group Presentation so everyone in your group has access to it.


### R & Package Versions and Citation Information

In addition to citing journal articles and other references, in a full scientific paper you should cite what software was used for the analysis.

While it will not be a requirement to cite R and the packages used in the results slide show, you should have all the packages and their versions in your records (this rendered quarto document will be kept as that record).

Optionally, you can refer to [How to Cite R](https://docs.google.com/presentation/d/1RG4_R-MDOy1vbMz-M1gfOcMtgqWu9Kvv_R4ex5QdcVk/edit?usp=sharing) if you want to know how to cite in the text as well as the full citation in the Literature Cited section at the end of a scientific paper.

Run the code below to get a full record of the version of R and all packages used.


```{r}
#| label: sessionInfo

sessionInfo()

```

It is good to have a record of the actual citation information for R and the packages used.

Use the code below to get the information to cite R itself

```{r}
#| label: cite R

#citation info for base R 
citation()

```

Use the code below to cite the {tidyverse} package and then repeat the code replacing "tidyverse" with any other packages you need to cite

```{r}
#| label: citing packages

citation("tidyverse")
citation("ggpubr")
citation("rstatix")
citation("labelled")

```

### Render this File to HTML & Print to PDF

Don't forget to "render" your .qmd file when you are done.

-   Before you Render

    -   Make sure that each code chunk has an unique label name or no name

    -   Save this file and give it the name "macro_analysis_Name.qmd" (replace your name with the "Name" part)

-   Render this Quarto file to HTML (just select the Render menu item at the top of this window)

-   If the HTML file didn't already open in your browser, then click on the name of the file in the Files window and select "View in Web Browser"

-   Once the HTML file is open in your web browser, then use the print function within your browser to save it as a PDF. Please name your PDF file "macro_analysis_Name.pdf" (replace your name with the "Name" part)

-   Make sure the PDF file is saved somewhere on your computer that you can get to

-   Place a copy of the PDF file in your GROUP Google Drive folder for this class

Render straight to HTML, open the HTML file in your browser, and then "print" to a PDF file.

Make sure you add your name to the PDF file name: projectAnalysis_Pratt.pdf

Save a copy the PDF in your GROUP FOLDER.
